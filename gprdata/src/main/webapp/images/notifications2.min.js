function executeOnJqueryLoad(){"undefined"==typeof $?setTimeout(function(){executeOnJqueryLoad()},100):$(document).ready(function(){gpro.common.init(),gpro.info.init(),"undefined"!=typeof ShowVATForm&&ShowVATForm&&gpro.vat.init()})}if("undefined"==typeof gpro)var gpro={};gpro.common={init:function(){gpro.data.countrycode=location.pathname.substring(1,3),gpro.common.setupMask()},errorHandler:function(){},makeAjaxCall:function(e){var t=e.url?"/"+gpro.data.countrycode+"/"+e.url:"",o=e.params?e.params:{},a=e.success?e.success:function(e,t,o){gpro.common.errorHandler(this,t,o,e)},n=e.failure?e.failure:function(e,t){gpro.common.errorHandler(this,t,e)},i=e.type?e.type:"POST";$.ajax({type:i,url:t,cache:!1,dataType:"json",data:o,success:a,error:n})},setupMask:function(){!function(e){e.fn.mask=function(t,o){e(this).each(function(){if(void 0!==o&&o>0){var a=e(this);a.data("_mask_timeout",setTimeout(function(){e.maskElement(a,t)},o))}else e.maskElement(e(this),t)})},e.fn.unmask=function(){e(this).each(function(){e.unmaskElement(e(this))})},e.fn.isMasked=function(){return this.hasClass("masked")},e.maskElement=function(t,o){void 0!==t.data("_mask_timeout")&&(clearTimeout(t.data("_mask_timeout")),t.removeData("_mask_timeout")),t.isMasked()&&e.unmaskElement(t),"static"==t.css("position")&&t.addClass("masked-relative"),t.addClass("masked");var a="fixed"==t.css("position")?'absolute "important':"fixed !Important",n="body"==t[0].localName?"":"border-radius:5px;",i=e('<div class="loadmask" style="position:'+a+"; "+n+'"></div>');if(navigator.userAgent.toLowerCase().indexOf("msie")>-1&&(i.height(t.height()+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))),i.width(t.width()+parseInt(t.css("padding-left"))+parseInt(t.css("padding-right")))),navigator.userAgent.toLowerCase().indexOf("msie 6")>-1&&t.find("select").addClass("masked-hidden"),t.append(i),i.hide().fadeTo(250,.5),void 0!==o){var s=e('<div class="loadmask-msg" style="display:none; position:'+a+';"></div>');s.append("<div>"+o+"</div>"),t.append(s);var r=s.outerWidth()/2,c=s.outerHeight()/2;s.css({left:"50%",top:"50%",marginTop:"-"+c+"px",marginLeft:"-"+r+"px"}),s.fadeIn(250)}},e.unmaskElement=function(t){void 0!==t.data("_mask_timeout")&&(clearTimeout(t.data("_mask_timeout")),t.removeData("_mask_timeout")),t.find(".loadmask-msg,.loadmask").fadeOut(250,function(){e(this).remove()}),t.removeClass("masked"),t.removeClass("masked-relative"),t.find("select").removeClass("masked-hidden")}}(jQuery)},populateForm:function(e,t){{var o=$("#"+e);$(":input",o)}$.each(t,function(e,t){console.log(e,t),$("#"+e).val(t)})},getFormData:function(e){var t=e.serializeArray(),o={};return $.map(t,function(e){var t=e.name;o[t]?"string"==typeof o[t]?o[t]=[o[t],e.value]:o[t].push(e.value):o[t]=e.value}),o},isFormValid:function(e,t){e||($(".confirmpopup").mask(text_saving),e=$(".confirmpopup form"));var o=gpro.common.getFormData(e),a=(e.find("dl").hasClass("rowwed"),!0);$(".error",e).remove(),$(".fielderror",e).removeClass("fielderror");var n=[];if($.each(o,function(t,o){var i=!0,s="",r=$("#"+t,e),c="email"==r.attr("type"),l=r.attr("minlength"),p="false"==r.attr("allowblank")?!1:!0;if(p||("undefined"!=typeof l?l>o.length&&(i=!1,s=l+" "+ls.text_chars_req):0==o.length&&(i=!1,s="This field cannot be blank")),c){var d="undefined"==typeof r.attr("limit")?!1:r.attr("limit"),m={emails:o,limit:d},u=gpro.common.global.trimAndCheckUniqueEmails(m),f=u.emails,g=u.invalidemails,v=u.toomany;console.log(f,g,v,d),v&&(i=!1,s+="Too many emails added (Limit of "+d+")"),g.length>0&&(i=!1,s.length>0&&(s+="<br>"),s+="Invalid emails: "+g.join().replace(/,/g,", "))}i||(a=!1,n.push(r),r.addClass("fielderror"),r.parent().append('<p class="error error_'+t+'">'+s+"</p>"))}),!a){$(".confirmpopup").unmask();var i=n[0],s=i.closest(".tabcontent"),e=i.closest("form");if(s.length>0){var r=$('ul li a[href="#'+s.attr("id")+'"]',e),c=r.closest("ul"),l=c.hasClass("disabled");c.removeClass("disabled"),r.trigger("click"),l&&c.addClass("disabled")}}return a},centerPopup:function(e){e.length>0&&$.each(e,function(e,t){var t=$(t),o=t.outerWidth(),a=t[0].scrollHeight,n=$(window).height(),i=t.css("position");a>n?(t.css({marginLeft:-o/2,marginTop:0,top:0}),"fixed"==i&&t.css({height:n,overflow:"auto"})):t.css({marginLeft:-o/2,marginTop:-a/2,top:"50%",height:"auto"})})},confirmpopup:{title:"Title",body:"Body content",bodyAlign:"center",mask:'<div class="confirmmask"></div>',confirmtext:"Confirm",canceltext:"Cancel",link:"#nogo",fadeSpeed:250,id:1,create:function(e){var t=e.popupstyle?e.popupstyle:"",o=e.title?e.title:this.title,a=e.body?e.body:this.body,n=e.confirmtext?e.confirmtext:this.confirmtext,i=e.canceltext?e.canceltext:this.canceltext,s=e.additionalClasses?e.additionalClasses:"",r=e.confirmCallback?e.confirmCallback:function(){gpro.common.confirmpopup.remove({removeCallback:!1})},c=e.cancelCallback?e.cancelCallback:!1,l=e.style?e.style:"",p=e.xandy?e.xandy:"",d=this.fadeSpeed,m=e.buttoncolor?e.buttoncolor:"blue",u=e.animate?e.animate:!1,f=e.buttons?e.buttons:!1,g=e.id?e.id:this.id,v=e.helpFunction?e.helpFunction:!1,h="";if(e&&e.bodyAlign){switch(e.bodyAlign){case"left":h="textalign_left";break;case"right":h="textalign_right"}s+=" "+h}e&&e.width&&(l+=" width:"+e.width+"px;"),-1!=s.indexOf("red")&&(m="red");var k="";e.dontshowagain&&e.dontshowagain.length>0&&(k=' <span class="dontshowagain"><input type="checkbox" id="'+e.dontshowagain+'"> <label for="'+e.dontshowagain+'">'+text_dontshowagain+"</label></span>");var b='<a href="#nogo" class="button inverse confirmclick '+m+'">'+n+"</a>",y="";0!=e.canceltext&&(y='<a href="#nogo" class="button cancelclick">'+i+"</a>");var _="";0!=v&&(_='<b class="helpclick">?</b>');var x=b+y;if(0!=f){var C="";$.each(f,function(e,t){var o=t.style?t.style:"";C+='<a href="#nogo" class="button '+o+'" id="button_text'+e+'">'+t.text+"</a>",$(document).off("click","#button_text"+e),$(document).on("click","#button_text"+e,function(){if(t.handler)t.handler();else{var e=$(this).closest(".confirmpopup").attr("confirmpopupid");gpro.common.confirmpopup.remove({removeCallback:!1,id:e})}})}),x=C}var w='<div confirmpopupid="'+g+'" id="confirmpopup'+g+'" class="confirmpopup '+s+" "+t+'" style="'+l+" "+p+';" animate="'+u+'"><h1>'+o+'<span><b class="cancelclick">X</b>'+_+'</span></h1><div class="inner">'+a+'</div><div class="confirmfooter">'+x+k+"</div></div>",T=($(".confirmmask").length,this.mask);g&&(T=$(gpro.common.confirmpopup.mask).attr("id","confirmmask"+g).css("zIndex","10000"+this.id)),$("body").append(T),$("body").append(w);var L=$("#confirmpopup"+g);if(L.css("z-index","10000"+this.id),$("#confirmpopup"+g+" .confirmclick").bind("click",function(){r()}),$("#confirmpopup"+g+" .cancelclick").bind("click",function(){var e=$(this).closest(".confirmpopup").attr("confirmpopupid");c?c():gpro.common.confirmpopup.remove({removeCallback:!1,id:e})}),$("#confirmpopup"+g+" .helpclick").bind("click",function(){v()}),t&&$(".confirmmask").addClass("white"),$(".confirmmask").fadeTo(d,.7),$(".confirmpopup").fadeTo(d,1),u){var A=$(".confirmpopup"),H=A.outerWidth(),V=A.outerHeight(),O=V-2*V;A.css({marginLeft:-H/2,marginTop:-V/2,top:O}),$(".confirmpopup").animate({top:"50%"},500,"easeOutQuint")}else 0==p.length&&gpro.common.centerPopup($("#confirmpopup"+g));this.id++},remove:function(e){function t(e){e.remove(),o&&o()}var o=!1,a=!1;e&&(o=e.removeCallback?e.removeCallback:!1,a=e.id?e.id:!1);var n=$(".confirmpopup"),i=(1==n.length?!0:!1,$(0==a?".confirmpopup":"#confirmpopup"+a)),s=$(0==a?".confirmmask":"#confirmmask"+a),r=i.attr("animate");if("true"==r){var c=i.outerHeight(),l=c-2*c;i.animate({top:l},500,"easeInQuint").promise().done(function(){s.fadeOut(500,function(){s.remove(),t(i)})})}else{var p=this.fadeSpeed;s.fadeOut(p),i.fadeOut(p).promise().done(function(){s.remove(),t(i)})}}}},gpro.vat={init:function(){gpro.vat.createListeners(),gpro.vat.showVATPopup()},createListeners:function(){$("body").on("click","#vatpopup",function(e){gpro.vat.showVATPopup(this,e)})},vatCountries:["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK"],VATLookup:function(){var e=!0;$(".formerror").remove(),$(".fielderror").removeClass("fielderror");var t=$("#form_vat"),o=gpro.common.getFormData(t);if(o.vatnumber=o.vatnumber.replace(/\s/g,""),0==o.companyname.length&&($("#companyname").addClass("fielderror"),$("#companyname").parent().append('<p class="formerror">'+ls.text_this_field_cant+"</p>"),e=!1),o.vatnumber<2&&($("#vatnumber").addClass("fielderror"),$("#vatnumber").parent().append('<p class="formerror">'+ls.text_vat_nr_too_shor+"</p>"),e=!1),e){$(".confirmpopup").mask(ls.text_saving);var a={url:"ajUpdateVATDetails.asp",params:{vatnumber:o.countrycode+o.vatnumber,companyname:o.companyname,companyaddress:o.companyaddress},success:function(){gpro.common.confirmpopup.remove()},failure:function(){}};gpro.common.makeAjaxCall(a)}},cancelVAT:function(){gpro.common.confirmpopup.remove();var e={url:"ajUpdateVATDetails.asp",params:{cancelVAT:1},success:function(){}};gpro.common.makeAjaxCall(e)},showVATPopup:function(){var e="thirty",t="seventy",o='<select name="countrycode" id="countrycode" class="thirty">';$.each(gpro.vat.vatCountries,function(e,t){o+='<option value="'+t+'">'+t+"</option>"}),o+="</select>";var a="<p>"+ls.text_if_u_give_us+'</p><form id="form_vat" class="exactwidths"><dl class="rowwed"><dt class="'+e+'"><label>'+ls.text_vat_nr+'</label></dt><dd class="'+t+'">'+o+'<input id="vatnumber" name="vatnumber" class="seventy" type="text" maxlength="13" allowblank="false"></dd><dt class="'+e+'"><label>'+ls.text_comp_name+'</label></dt><dd class="'+t+'"><input id="companyname" name="companyname" type="text" allowblank="false"></dd><dt class="'+e+'"><label>'+ls.text_comp_addr+'</label></dt><dd class="'+t+'"><textarea id="companyaddress" name="companyaddress"></textarea></dd></dl></form>',n={title:ls.text_do_u_have_VAT,body:a,confirmtext:ls.save,additionalClasses:"textalign_left blue",style:"width:650px",canceltext:ls.text_cancel,animate:!0,confirmCallback:function(){gpro.vat.VATLookup()},cancelCallback:function(){gpro.vat.cancelVAT()}};gpro.common.confirmpopup.create(n),vatdetails&&gpro.common.populateForm("form_vat",vatdetails)}},gpro.info={init:function(){gpro.info.createListeners(),gpro.info.createLanguageHTML()},createListeners:function(){$("body").on("click","#info_notifications, #info_languageselector",function(e){gpro.info.showPopout(this,e)}),$("body").on("click","#info_mail",function(e){var t=$(e.target);if(t.hasClass("tagged")){e.preventDefault();var o=$("#info_mail").attr("href")+"?mailSelect=tagged";return window.location.href=o,!1}}),$(document).click(function(e){gpro.info.removePopout(e)}),$(window).resize(function(){gpro.info.alignPopout()})},removePopout:function(e){var t=$(e.target);t.hasClass("popout")||t.closest(".popout").length>0||t.hasClass("noti")&&"#nogo"==t.attr("href")||t.closest(".noti").length>0||($(".popout").fadeOut(250,function(){$(this).remove()}),$(".noti").removeClass("active"))},alignPopout:function(){var e=$(".popout");if(e.length>0){var t=$("#"+e.attr("linked")),o=t.outerWidth(),a=t.outerHeight(),n=(t.offset().top+a,t.offset().left),i=e.outerWidth(),s=n-(i-o/2-26);$(".popout").css("left",s)}},createLanguageHTML:function(){var e=$("#languages");e.length>0&&(gpro.data.languagesHTML='<ul id="languages">'+$("#languages").html()+"</ul>")},showPopout:function(e){var t=$(e),o=e.id,a=t.outerWidth(),n=t.outerHeight(),i=t.offset().top+n,s=t.offset().left;if(t.hasClass("active"))t.removeClass("active"),$(".popout").fadeOut(250,function(){$(this).remove()});else{$(".noti").removeClass("active"),t.addClass("active"),$(".popout").remove();var r="",c="";switch(o){case"info_languageselector":gpro.data.languagesHTML||gpro.info.createLanguageHTML(),c=gpro.data.languagesHTML;break;case"info_notifications":if(gpro.data.notificationsHTML)c=gpro.data.notificationsHTML,setTimeout(function(){$(".popout .inner").perfectScrollbar()},50);else{var l=function(e){var t="";e.notifications.length>0?($.each(e.notifications,function(e,o){var a=0==o.type.length?"info":o.type,n=(0==o.link.length?"":'<p><a class="button blue inverse mini" href="'+o.link+'">Click Here</a></p>',"a"==o.type?"<h2>"+newAchievement+"</h2>":""),i='<span class="noti_image" style="background-image:url(/images/icon_noti_'+a+'.png);"></span><span class="noti_text">'+n+"<h3>"+o.title+"</h3><p>"+o.description+"</p></span>";o.link&&o.link.length>0&&(i='<a href="'+o.link+'">'+i+"</a>"),t+='<div class="noti_block">'+i+"</div>"}),t+='<div class="center noti_block"><a class="all_noti" href="/ViewNotifications.asp">'+viewAllNotif+"</a></div>"):(t='<div class="noti_block"><span class="noti_text all_noti center"><br><p>'+nonotif+"</p></span></div>",t+='<div class="center noti_block"><a class="all_noti" href="/ViewNotifications.asp">'+viewAllNotif+"</a></div>"),gpro.data.notifications=e.notifications,gpro.data.notificationsHTML=t;var a=$(".popout");a.length>0&&a.hasClass(o)&&($(".inner",a).html(t),gpro.info.alignPopout(),$(".popout .inner").perfectScrollbar())},p={url:"ajGetNotifications.asp",success:l};gpro.common.makeAjaxCall(p),c='<div class="noti_block"><span class="noti_text message"><p class="loading">Loading...</p></span></div>',r="loading"}}var d='<div class="popout '+o+" "+r+'" linked="'+o+'" style="top:'+(i+8)+'px; left:-999em;"><b class="arrow"></b><div class="inner">'+c+"</div></div>";$(d).appendTo("body");var m=$(".popout").outerWidth(),u=s-(m-a/2-26);$(".popout").hide().css("left",u).fadeIn(250)}}},"undefined"==typeof gpro.data&&(gpro.data={}),executeOnJqueryLoad();